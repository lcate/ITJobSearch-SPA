<div class="container" style="margin-top:5%">

  <!-- job application details -->
  <table class="table table-condensed table-bordered table-striped table-hover">
    <thead>
      <tr>
        <th>id</th>
        <th>joboffer id</th>
        <th>User name</th>
        <th>CV</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      <tr class="clickable" [routerLink]="['/jobapplications/details/', jobApplication.id]">
        <td>{{jobApplication.id}}</td>
        <td>{{jobApplication.jobOfferId}}</td>
        <td>{{jobApplication.user.fullName}}</td>
        <td>
            <app-download [fileUrl]="jobApplication.imgPath"></app-download>
        </td>
        <td>
          <!-- if user -->
          <div *ngIf="!isCompanyUser">
            <span *ngIf="jobApplication.status == 0" class="badge badge-pill badge-warning badges-big">Pending</span>
            <span *ngIf="jobApplication.status == 1" class="badge badge-pill badge-success badges-big">Hired</span>
            <span *ngIf="jobApplication.status == 2" class="badge badge-pill badge-danger badges-big">Declined</span>
          </div>
          <!-- if company -->
          <div *ngIf="isCompanyUser">
            <span *ngIf="jobApplication.status == 1" class="badge badge-pill badge-success badges-big" [ngbTooltip]="'Hired'">Hired</span>
            <span *ngIf="jobApplication.status == 2" class="badge badge-pill badge-danger badges-big" [ngbTooltip]="'Declined'">Declined</span>
          </div>
          <div *ngIf="isCompanyUser && jobApplication.status == 0">
            <button (click)="hiredClick()" style="margin-bottom: 20%;" class="badge badge-pill badge-success badges-big">Hired</button><br>
            <button (click)="declinedClick()" class="badge badge-pill badge-danger badges-big">Declined</button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <section *ngFor="let comment of comments">
    <div class="container text-dark">
      <div class="row d-flex justify-content-center">
        <div class="col-md-12 col-lg-12 col-xl-12">
          <div class="card">
            <div class="card-body p-4">
              <div class="d-flex flex-start w-100"  [ngClass]="{'flex-row-reverse': userEmail == comment.user.email}">
                <img
                  class="rounded-circle shadow-1-strong me-3"
                  style="margin-right: 2%;"
                  [src]="createImgPath(comment.user.profilePicture)"
                  alt="avatar"
                  width="65"
                  height="65"/>
                <div class="w-100 d-flex justify-content-between" [ngClass]="{'flex-row-reverse': userEmail == comment.user.email}">
                  <div>
                    <h5>{{comment.user.fullName}} </h5>
                    <div class="form-outline" >
                      <p> {{comment.message}} </p>
                    </div>
                  </div>
                  <div *ngIf="comment.file">
                    <p> {{comment.dateCreated | date:'dd MMM yyyy hh:mm a'}} </p>
                    <app-download [fileUrl]="comment.file"></app-download>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>


  <section>
    <div class="container text-dark">
      <div class="row d-flex justify-content-center">
        <div class="col-md-12 col-lg-12 col-xl-12">
          <div class="card">
            <div class="card-body p-4">
              <div class="d-flex flex-start w-100">
                <img
                  class="rounded-circle shadow-1-strong me-3"
                  [src]="createImgPath(user.profilePicture)"
                  style="margin-right: 2%;"
                  alt="avatar"
                  width="65"
                  height="65"/>
                <div class="w-100">
                  <h5>Add a feedback</h5>
                  <div class="form-outline">
                    <form [formGroup]="commentForm">
                      <textarea class="form-control" id="commentMessage" rows="4" formControlName="commentMessage"></textarea>
                    </form>
                  </div>
                  <div class="d-flex justify-content-between mt-3">
                    <app-upload (onUploadFinished)="uploadFinished($event)" [message]="message"></app-upload>
                    <button type="button" class="btn btn-danger" (click)="addComment()"> Send <i class="fas fa-long-arrow-alt-right ms-1"></i></button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>
